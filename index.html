<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Rick Jump - Upgrade Edition</title>
    <style>
        body { margin: 0; background: #000; overflow: hidden; font-family: 'Courier New', sans-serif; }
        canvas { display: block; background: linear-gradient(#001, #002, #005); }
        
        #ui { 
            position: absolute; top: 10px; width: 100%; text-align: center; 
            color: white; font-size: 28px; font-weight: bold; pointer-events: none; z-index: 10;
        }

        /* DIN RICKROLL KODE HER */
        #rickRollOverlay {
            display: none; 
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: black;
            z-index: 9999;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        #rickVideo {
            width: 100%;
            max-height: 80vh;
        }

        #rickRollOverlay button {
            margin-top: 20px;
            padding: 15px 30px;
            font-size: 20px;
            cursor: pointer;
            background: #fff;
            border: none;
            border-radius: 10px;
            font-weight: bold;
        }
    </style>
</head>
<body>

    <div id="ui">SCORE: 0</div>

    <div id="rickRollOverlay">
        <video id="rickVideo" playsinline loop>
            <source src="https://dn721809.ca.archive.org/0/items/youtube-xvFZjo5PgG0/xvFZjo5PgG0.mp4" type="video/mp4">
        </video>
        <button onclick="location.reload()">PRØV IGJEN</button>
    </div>

    <canvas id="game"></canvas>

<script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const ui = document.getElementById('ui');

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    let score = 0;
    let gameActive = true;
    const gravity = 0.4;
    const jumpStrength = -14;
    
    // Rick som en stilig sirkel/hode (siden vi ikke bruker eksterne bilder akkurat nå)
    const rick = {
        x: canvas.width / 2, y: canvas.height - 200,
        w: 40, h: 40, vy: 0, vx: 0,
        isJetpack: false, jetpackTimer: 0
    };

    let platforms = [];
    let powerups = [];
    const platW = 75;
    const platH = 15;

    function initGame() {
        platforms = [];
        // Spawn på en trygg plattform
        platforms.push({ x: rick.x - 20, y: rick.y + 60, type: 'normal' });

        for (let i = 1; i < 8; i++) {
            addPlatform(canvas.height - (i * (canvas.height / 7)));
        }
    }

    function addPlatform(yPos) {
        let type = Math.random() > 0.85 ? 'break' : 'normal';
        let x = Math.random() * (canvas.width - platW);
        platforms.push({ x, y: yPos, type });

        // Sjanse for Powerup (Mikrofon)
        if (Math.random() > 0.92) {
            powerups.push({ x: x + 25, y: yPos - 30, w: 20, h: 25, collected: false });
        }
    }

    // DIN JAVASCRIPT FUNKSJON (Integrert)
    function triggerRickRoll() {
        const overlay = document.getElementById('rickRollOverlay');
        const video = document.getElementById('rickVideo');
        overlay.style.display = 'flex'; 
        video.play().catch(e => console.log("Blokkert"));
    }

    // Kontroller
    window.addEventListener('touchstart', (e) => {
        if (!gameActive) return;
        rick.vx = (e.touches[0].clientX < canvas.width / 2) ? -7 : 7;
    });
    window.addEventListener('touchend', () => rick.vx = 0);

    function update() {
        if (!gameActive) return;

        // Gravity og bevegelse
        if (rick.isJetpack) {
            rick.vy = -10;
            rick.jetpackTimer--;
            if (rick.jetpackTimer <= 0) rick.isJetpack = false;
        } else {
            rick.vy += gravity;
        }

        rick.y += rick.vy;
        rick.x += rick.vx;

        // Wrap-around
        if (rick.x > canvas.width) rick.x = -rick.w;
        if (rick.x < -rick.w) rick.x = canvas.width;

        // Kollisjon med plattformer
        if (rick.vy > 0) {
            platforms.forEach((p, i) => {
                if (rick.x + rick.w > p.x && rick.x < p.x + platW && 
                    rick.y + rick.h > p.y && rick.y + rick.h < p.y + platH + 10) {
                    if (p.type === 'break') {
                        platforms.splice(i, 1);
                    } else {
                        rick.vy = jumpStrength;
                    }
                }
            });
        }

        // Powerup kollisjon
        powerups.forEach((pu, i) => {
            if (!pu.collected && rick.x < pu.x + pu.w && rick.x + rick.w > pu.x && rick.y < pu.y + pu.h && rick.y + rick.h > pu.y) {
                pu.collected = true;
                rick.isJetpack = true;
                rick.jetpackTimer = 100; // Varighet
            }
        });

        // Kamera-scroll
        if (rick.y < canvas.height / 2) {
            let diff = canvas.height / 2 - rick.y;
            rick.y = canvas.height / 2;
            score += Math.floor(diff / 10);
            ui.innerText = "SCORE: " + score;

            platforms.forEach((p, i) => {
                p.y += diff;
                if (p.y > canvas.height) {
                    platforms.splice(i, 1);
                    addPlatform(0);
                }
            });
            powerups.forEach((pu, i) => {
                pu.y += diff;
                if (pu.y > canvas.height) powerups.splice(i, 1);
            });
        }

        // Tapt spillet
        if (rick.y > canvas.height) {
            gameActive = false;
            triggerRickRoll();
        }

        draw();
        requestAnimationFrame(update);
    }

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Tegn Rick
        ctx.fillStyle = rick.isJetpack ? 'gold' : '#ffcc99';
        ctx.beginPath();
        ctx.arc(rick.x + 20, rick.y + 20, 20, 0, Math.PI * 2);
        ctx.fill();
        // Hår (Rick-stil)
        ctx.fillStyle = '#663300';
        ctx.fillRect(rick.x + 5, rick.y, 30, 10);

        // Plattformer
        platforms.forEach(p => {
            ctx.fillStyle = p.type === 'break' ? '#ff4444' : '#44ff44';
            ctx.fillRect(p.x, p.y, platW, platH);
        });

        // Powerups (Mikrofon)
        powerups.forEach(pu => {
            if (!pu.collected) {
                ctx.fillStyle = 'silver';
                ctx.fillRect(pu.x, pu.y, pu.w, pu.h);
                ctx.fillStyle = 'gold';
                ctx.fillRect(pu.x, pu.y - 5, pu.w, 10);
            }
        });
    }

    initGame();
    update();
</script>
</body>
</html>
